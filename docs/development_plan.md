# 项目开发计划

本项目将采用敏捷开发的模式，分阶段迭代，确保核心功能优先上线并快速响应变化。

---

### 第一阶段：项目奠基与UI构建 (已完成)

- **任务**:
    - [x] 初始化Flutter项目，搭建基础文件夹结构。
    - [x] 编写项目说明和开发计划文档。
    - [x] 基于Material 3 完成核心页面静态UI构建。
    - [x] 搭建基础的状态管理框架。

---

### 第二阶段：核心功能实现 (Android) (已完成)

- **任务**:
    - [x] **关键任务**: 在Android端实现 `NotificationListenerService` 以捕获通知。
    - [x] **架构优化**: 将服务升级为**前台服务**，确保后台存活率。
    - [x] **架构优化**: 搭建Flutter与原生的统一数据流（`EventChannel`），移除原生端所有判断逻辑，由Flutter统一处理。
    - [x] 实现支付通知的精确解析，并弹出"交易确认"对话框。
    - [x] 实现本地数据库 (`sqflite`) 的集成，完成交易记录的持久化。
    - [x] **关键修复**: 解决因系统策略导致的后台通知不显示、服务被杀、应用闪退等一系列问题。
    - [x] (增强) 实现独立的、可持久化的调试日志系统。
    - [x] (增强) 在调试页面中加入功能强大的通知模拟器，并接入统一数据流。
    - [x] 从通知栏的系统通知点进去后，没有显示记账的窗口，但是支付后不点系统通知而是且回到app会显示记账窗口
    - [ ] (增强) 支付通知解析逻辑支持多模式匹配，采用可扩展的规则体系，便于适配支付宝、微信等不同版本和文案格式。
    - [ ] 引导界面 ，横幅检测不真实、提醒设置 电池管理允许应用完全后台、获取通知权限 应该跳转到 其他特殊权限 页面

---

### 第三阶段：功能完善与体验优化 (规划中)

- **任务**:
    - [ ] **账单分类管理**: 实现自定义账单类型（如餐饮、交通、购物等）的增删改查功能。
    - [ ] **历史账单编辑与删除**: 在历史记录页面，增加对单条账单的修改和删除操作。
    - [ ] **手动记账功能**: 完成首页悬浮按钮（FAB）的完整手动记账流程。
    - [ ] **历史记录高级筛选**: 实现按分类、关键字、金额范围对历史记录进行筛选和排序。
    - [ ] **增强数据可视化**: 优化首页饼图交互，允许点击图表部分高亮显示，并联动展示对应分类的账单。
    - [x] **权限引导流程优化**: 完善权限引导，增加对"后台弹出界面"、"前台服务"等权限的图文说明。
    - [ ] 编写单元测试和集成测试，保障代码质量。

---

### 第四阶段：构建与发布 (部分完成)

- **任务**:
    - [ ] **重要**: 确认并移除/关闭所有调试功能 (如调试日志页面)。
    - [ ] 配置 `build.gradle.kts` 和 `Info.plist`，更新应用版本号、图标等信息。
    - [x] 设置Github Actions CI/CD, 实现自动化构建APK/AppBundle。
    - [ ] 进行多轮回归测试。
    - [ ] 准备应用商店上架所需材料，发布Beta版本。

---

### 第五阶段：长期规划：云同步与多端支持 (概念阶段)

- **任务 (借鉴自 AutoBookKeepingBeta v1.2)**:
    - [ ] **架构升级：引入云服务**: 设计并实现后端服务，用于用户账户管理和账单数据云端备份。
    - [ ] **用户系统**: 实现用户注册、登录、个人信息（昵称、头像）管理功能。
    - [ ] **数据同步**: 实现移动端与云端的账单数据双向同步。
    - [ ] **(可选) 家庭共享账本**: 在云同步基础上，实现多用户间的账本共享功能。 